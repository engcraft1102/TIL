# 멀티프로그래밍, 멀티프로세싱, 멀티태스킹, 멀티스레딩

## 선수지식 키워드

- OS란 무엇인가?
- 싱글코어, 멀티코어
- 프로그램, 프로세스, 그리고 스레드

### 싱글코어, 멀티코어

- `Core`: CPU에서 기초적인 연산을 처리하고 담당하는 부분. 사람의 대뇌.
- `Multi Core`: 하나의 CPU 안에 여러개의 코어를 구현해 놓은 아키텍쳐.
  - 듀얼코어, 쿼드코어 CPU가 그 예이다.
  - 듀얼 코어의 경우 단일 코어에 비해 필요한 서버 수가 절반이며, 관리할 시스템 수도 적어 유지/보수비용이 적게 든다.
- `Hyper-Threading`: 인텔에서 개발한 기술. 하나의 코어가 논리적으로 두 개 이상의 코어처럼 동작하도록 설계한 기술.

### 프로그램, 프로세스, 그리고 스레드

- `Program`: 저장소에 존재하는 코드와 정적 데이터들의 뭉치
- `Process`: 메모리에 적재되어 실행중인 프로그램
- `Thread`: 프로세스 안의 작은 실행단위. Data, Code, Heap 영역은 공유하고 스레드 각각의 Stack을 할당받는다.

## 혼란스러운 네 가지의 개념 :scream:

`멀티프로그래밍, 멀티프로세싱, 멀티태스킹, 멀티스레딩`은 혼란을 야기한다.

현대 컴퓨팅 시스템에는 일반적으로 CPU와 같이 적은 리소스를 놓고 경쟁하는 여러 동시 응용 프로 실행 프로세스들이 있다. 운영 체제는 효과적이고 효율적인 리소스의 할당을 담당하고, 그것을 위해 스케줄러를 사용한다. OS에 따라 다른 스케줄링 정책이 실행될 수 있다.

## 멀티프로그래밍

초창기 싱글코어, 싱글 스레드 컴퓨터에서는 프로그램이 메모리에 하나만 올라가고, 해당 프로그램만 CPU가 처리할 수 있었다. 이런 과정에서 프로그램이 파일 입출력(I/O)을 하게 되면 중간에 `idle 정지` 상태가 되는데 이 때 `자원 낭비를 막기 위해` 다른 프로세스의 일부를 처리하는 것이 멀티프로그래밍이다.

따라서 멀티프로그래밍의 궁극적인 목표는 실행할 준비가 된 프로세스가 있는 한, CPU를 계속 바쁘게 굴리는 것이다.

이러한 시스템이 제대로 작동하려면 os가 여러 프로그램을 메인 메모리의 별도 영역에 로드할 수 있어야 하고 한 프로세스가 다른 프로세스에 의해 수정될 가능성을 피하기 위해 필요한 보호를 제공해야 한다.

## 멀티프로세싱

![img](multi-task_program_thread_process.assets/image.png)

멀티프로그래밍과 헷갈릴 오해의 소지가 있다.

사실 멀티프로세싱은 `소프트웨어(실행 중인 프로세스)`가 아니라 `하드웨어(CPU)`를 의미한다.

다수의 프로세서(CPU)가 협력적으로 일을 처리하는 것이다. 하나의 컴퓨터에 여러개의 CPU 혹은 멀티코어를 통해 하나 이상의 프로세스를 동시에 처리하는 것을 의미한다.

더 넓은 의미에서는 하나 또는 그 이상의 프로세스를 여러 장치에서 병렬로 처리하는 것을 의미한다.

## 멀티태스킹

![img](multi-task_program_thread_process.assets/image-16317932418253.png)

`Task`란 os에서 처리하는 작업의 단위 또는 정해진 일을 수행하기 위한 명령어 집합을 뜻한다. (`Process`의 확장 개념)

멀티 태스킹은 이 task를 os의 스케줄링에 의해 번갈아가며 수행하는 것을 의미한다.

이를 통해 여러 작업이 빠르게 처리되어 마치 동시에 처리되는 것처럼 보이는 것이다.

### 멀티태스킹 시스템

![img](multi-task_program_thread_process.assets/image-16317932664755.png)

### 멀티프로그래밍 vs 멀티태스킹

`멀티프로그래밍`은 프로세서의 자원낭비를 막기 위함이고, 

`멀티태스킹`은 정해진 시간동안 task를 번갈아가며 수행하여 마치 동시에 실행되는 착각을 주기 위함이다.

![img](multi-task_program_thread_process.assets/99AD02405FBBB94910.png)

## 멀티스레딩

프로세스 내에서 하나가 아닌 여러 개의 스레드를 사용해 명령을 처리하는 것을 의미한다.여러 개의 스레드끼리 자원을 공유한다.

### 멀티프로세싱 vs 멀티스레딩

`멀티프로세싱`은 fork를 통해 다수의 프로세스를 만들어서 여러 개의 프로그램들을 병렬로 처리하며,

`멀티스레딩`은 하나의 프로그램 안에서 작업을 병렬처리 하는 것이다.

멀티 스레딩은 멀티 프로세싱보다 적은 자원을 소모하기에 효율적이지만, 안정성 측면에서는 멀티 프로세싱이 좋다. 프로세스와 달리 스레드는 `code, heap, data`를 공유하기 때문에 다른 하나가 문제가 생기면 연쇄적인 문제가 생길 수 있기 때문.

### 멀티스레딩 vs 멀티태스킹

`멀티스레딩`은 스레드들끼리의 자원 공유가 가능하며 프로그래밍을 통해 구현 가능하나,

`멀티태스킹`은 OS에서 지원하는 것으로 독립된 메모리를 가지며  서로 간의 자원공유가 이루어지지 않는다.


## Reference

- https://twpower.github.io/127-multi-processing-threading-programming
- https://gabrieletolomei.wordpress.com/miscellanea/operating-systems/multiprogramming-multiprocessing-multitasking-multithreading/